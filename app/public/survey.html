<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>FriendFinder</title>

 
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


    <!-- Custome CSS Style sheet -->
    <link rel="stylesheet" type='text/css' href='/css/style.css'>

</head>

<body>
<div class="container">
    <div class="jumbotron">
        <img class='logo' src='/images/friends.jpg' height=150 width=150 alt="Friends">

        <h1>Friend Finder Survey</h1>
        <h3>Be sure to enter your name and photo link, in the "About You" section and then, answer all of the Questions.</h3>
        <a href="/"><button class="btn btn-primary btn-md"><span class="fa fa-plus"></span> Back to Home</button></a>
        <br>
    </div>
    <div class="row">


        <!-- Modal HTML -->
        <div class="modal" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title"></h5>
                        <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close"> -->
                        <span aria-hidden="true">&times;</span>
                        </button>
                    </div>

                    <div class="modal-body">

                        
                        <p id=matchname></p>
                        
                        <div id='matchphoto'>
                        <!-- PHOTO -->
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Close</button>
                    </div>
                    </div>
                </div>
        </div>
        <!-- End of Modal -->


        <div class="col-md-12">
            <h4>About You</h4>
   
            <form  id="friend-form">
                    <div class="form-group">
                        <label for="exampleInputEmail1">Name (Required)</label>
                        <input type="text" class="form-control" id="name" aria-describedby="emailHelp" placeholder="Enter name">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputPassword1">Link to Photo Image (Required)</label>
                        <input type="text" class="form-control" id="photo" placeholder="Enter link to picture">
                    </div>
            
        </div>
        <div class="col-md-12">
            <hr>

            <!-- Survey Questions Below -->
            
            <div class="form-group">

                <!-- Question 1 -->
                <h4>Question 1</h4>
                    <label for="Q1">Your mind is always buzzing with unexplored ideas and plans.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q1">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>

            <div class="form-group">
                <h4>Question 2</h4>
                    <label for="Q2">Generally speaking, you rely more on your experience than your imagination.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q2">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>
    
            <div class="form-group">
                <h4>Question 3</h4>
                    <label for="Q3">You find it easy to stay relaxed and focused even when there is some pressure.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q3">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>

            <div class="form-group">
                <h4>Question 4</h4>
                    <label for="Q4">You rarely do something just out of sheer curiosity.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q4">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>

            <div class="form-group">
                <h4>Question 5</h4>
                    <label for="Q5">People can rarely upset you.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q5">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>
   
            <div class="form-group">
                <h4>Question 6</h4>
                    <label for="Q6">It is often difficult for you to relate to other people’s feelings.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q6">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>
   
            <div class="form-group">
                <h4>Question 7</h4>
                    <label for="Q7">In a discussion, truth should be more important than people’s sensitivities.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q7">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>
           
            <div class="form-group">
                <h4>Question 8</h4>
                    <label for="Q8">You rarely get carried away by fantasies and ideas.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q8">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>
      
            <div class="form-group">
                <h4>Question 9</h4>
                    <label for="Q9">You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q9">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>
      
            <div class="form-group">
                <h4>Question 10</h4>
                    <label for="Q10">You feel more energetic after spending time with a group of people.</label>
                    <div class='col-md-3'>
                        <select class="form-control" id="q10">
                        <option selected>Select Answer ...</option>
                        <option>1 (Strongly Agree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Disagree)</option>
                        </select>
                    </div>
            </div>
            <br>
            <button id='submit' type="button" class="btn btn-primary btn-md btn-block">Submit</button>
            <br>
            </form>
    </div>
    </div>
    <footer class="footer">
            <div class="container">
              <p id="smallfooter"><a href="/api/friends">API Friends List</a> | <a href="https://github.com/alakoff/FriendFinder">Github Repo</a></p>
            </div>
          </footer>
    </div>


<script>

    function getScores(){
        
        var scores = [];

        for (i=1;i<11;i++){
            if ($('#q'+i).val() !== 'Select Answer ...' && $('#q'+i).val() !== ''){
                scores.push($("#q"+i).val().slice(0,1).trim());
            } else {         
                return scores
            }
        }
        return scores
    }


    // On click listener for submit button to add friend
    $("#submit").on("click", function(event) {
        event.preventDefault();

        var errFlag = 'N';

        // Call function to add scores
        var scores = getScores();
        if (scores.length !== 10){
            errFlag = 'Y';
        }
        
        // Handle name validation
        if ($('#name').val() !== 'Enter name' && $('#name').val() !== ''){
                var name = $("#name").val().trim();
            } else {
                errFlag = 'Y';
            }

        // Handle picture validation
        if ($('#photo').val() !== 'Enter link to picture' && $('#photo').val() !== ''){
            var photo = $("#photo").val().trim();
        } else {
            errFlag = 'Y';
        }

        // Create json object to hold new friend info
        if (errFlag === 'N') {

            var newFriend = {
                name: name,
                photo: photo,
                scores: scores
            };

            //Send to new friend object to server
            $.post("/api/friends", newFriend, function(data) {
                // console.log("best match", data);
                name = '';
                photo = '';
                scores = [];

                // Show modal
                $(".modal-title").text('Here is your friend best match !');
                $("#matchname").text(data.name);
                $("#matchphoto").html(`<img src="${data.photo}" height=150 width=150 alt='Friend'></img>`);
                $('.modal').modal('show');

                // Clear form input fields
                $('#name').val('Enter name');
                $('#photo').val('Enter link to picture');
                for (i=1;i<11;i++) {
                    $("#q"+i).val('Select Answer ...');
                }

                
            })

        } else {

            alert('All information must be completed');
            errFlag = 'N';
        }
 })

</script>

</body>
</html>